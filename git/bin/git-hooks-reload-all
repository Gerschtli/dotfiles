#!/usr/bin/env bash

source "${HOME}/.dotfiles-variables"

list=("${DOTFILES_ROOT}")
[[ -w "${DOTFILES_ROOT}/gpg" ]]         && list+=("${DOTFILES_ROOT}/gpg")
[[ -w "${DOTFILES_ROOT}/ssh/modules" ]] && list+=("${DOTFILES_ROOT}/ssh/modules/"*/)
[[ -w "${HOME}/projects" ]]             && list+=("${HOME}/projects/"*/)
[[ -w "${HOME}/projects/profitmax" ]]   && list+=("${HOME}/projects/profitmax/"*/)
[[ -w "/etc/nixos" ]]                   && list+=("/etc/nixos")

for dir in "${list[@]}"; do
    if [[ -w "${dir}/.git" ]]; then
        rm -rf "${dir}/.git/hooks"
        git -C "${dir}" init --template="${DOTFILES_ROOT}/git/git.symlink/template"
    fi
done
