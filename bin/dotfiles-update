#!/bin/bash

print() {
    printf "[\033[00;34mINFO\033[0m] ${1}\n"
}

set -e

pushd "$(dirname "$0")/.." 1> /dev/null

print "git fetch --prune ..."
git fetch --prune

print "git checkout master ..."
git checkout master

print "git stash ..."
git stash

print "git rebase -n origin/master ..."
git rebase -n origin/master

if [[ $(git stash list | wc -l) -gt 0 ]]; then
    print "git stash pop ..."
    git stash pop
fi

print "./bootstrap.sh ..."
./bootstrap.sh

popd 1> /dev/null

exit 0
