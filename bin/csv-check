#!/bin/bash -e

URL="$1"
NAME="${2:-test}.csv"

rm -f "${NAME}"

echo $'\n'
curl -L "$URL" -o "$NAME"
echo $'\n'

file "$NAME" | grep "Zip archive data" > /dev/null

if [[ "$?" == 0 ]]; then
    rm -rf csv
    unzip -d "csv" "$NAME"
    echo $'\n'
    NAME=csv/*
fi;

file $NAME
echo $'\n'

wc -l $NAME
echo $'\n'

head -n5 $NAME
echo $'\n'

tail -n5 $NAME
echo $'\n'

exit 0
